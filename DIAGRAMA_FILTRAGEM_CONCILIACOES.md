## ğŸ” Diagrama de Filtragem - HistÃ³rico de ConciliaÃ§Ãµes

### Arquitetura Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND: Componente historico-conciliacoes-tabs.blade.php      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚         SEGMENTED TABS TOOLBAR                       â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚
â”‚  â”‚  â”‚ Todosâ”‚Conciliadosâ”‚Pendentesâ”‚Ignoradosâ”‚Divergentesâ”‚ â”‚       â”‚
â”‚  â”‚  â”‚ (21) â”‚  (15)    â”‚  (3)   â”‚ (2)   â”‚   (1)    â”‚ â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                          â†“ CLICK                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚     TAB CONTENT (Table Body)                         â”‚       â”‚
â”‚  â”‚  DinÃ¢mica (carregada via AJAX)                       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                          â†“ FETCH                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ URL: /entidades/{id}/historico-conciliacoes
                          â”‚ Query Params:
                          â”‚   - status = 'all'|'ok'|'pendente'|'ignorado'|'divergente'
                          â”‚   - per_page = 10-100
                          â”‚   - q = search text
                          â”‚
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND: EntidadeFinanceiraController::historicoConciliacoes() â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1ï¸âƒ£  VALIDAÃ‡ÃƒO                                                    â”‚
â”‚     âœ“ SessÃ£o com active_company_id                              â”‚
â”‚     âœ“ Entidade pertence Ã  empresa ativa                         â”‚
â”‚                                                                  â”‚
â”‚  2ï¸âƒ£  PARSING DE PARÃ‚METROS                                       â”‚
â”‚     status = 'all' | 'ok' | 'pendente' | 'ignorado' | ...      â”‚
â”‚     per_page = 10-100                                           â”‚
â”‚     q = search string                                           â”‚
â”‚                                                                  â”‚
â”‚  3ï¸âƒ£  QUERY BASE                                                  â”‚
â”‚     $query = BankStatement::query()                             â”‚
â”‚       ->where('company_id', $activeCompanyId)                  â”‚
â”‚       ->where('entidade_financeira_id', $id)                   â”‚
â”‚       ->with(['transacoes.lancamentoPadrao', ...])             â”‚
â”‚       ->latest('updated_at');                                  â”‚
â”‚                                                                  â”‚
â”‚  4ï¸âƒ£  FILTRO DE STATUS (CONDICIONAL)                              â”‚
â”‚     if (!in_array($status, ['all', 'todos'])) {               â”‚
â”‚       $query->where('status_conciliacao', $status);           â”‚
â”‚     }                                                           â”‚
â”‚                                                                  â”‚
â”‚  5ï¸âƒ£  BUSCA (Search)                                              â”‚
â”‚     if ($q !== '') {                                           â”‚
â”‚       $query->where(fn($w) => ...                             â”‚
â”‚         ->where('memo', 'like', "%{$q}%")                      â”‚
â”‚         ->orWhere('name', 'like', "%{$q}%")                    â”‚
â”‚         ...                                                     â”‚
â”‚       );                                                        â”‚
â”‚     }                                                           â”‚
â”‚                                                                  â”‚
â”‚  6ï¸âƒ£  PAGINAÃ‡ÃƒO                                                   â”‚
â”‚     $paginator = $query->paginate($perPage)                    â”‚
â”‚                                                                  â”‚
â”‚  7ï¸âƒ£  MAPEAMENTO DE DADOS                                         â”‚
â”‚     $dados = $paginator->getCollection()->map(fn($item) => [  â”‚
â”‚       'id' => $item->id,                                       â”‚
â”‚       'descricao' => $item->memo,                              â”‚
â”‚       'valor' => abs($item->amount),                           â”‚
â”‚       'status' => $item->status_conciliacao,                   â”‚
â”‚       ...                                                       â”‚
â”‚     ]);                                                         â”‚
â”‚                                                                  â”‚
â”‚  8ï¸âƒ£  RESPOSTA (JSON ou HTML)                                     â”‚
â”‚     if ($request->wantsJson() || AJAX) {                       â”‚
â”‚       return [                                                  â”‚
â”‚         'success' => true,                                      â”‚
â”‚         'html' => view(...)->render(),  // Retorna <tr>...</tr>â”‚
â”‚         'meta' => [...]                                        â”‚
â”‚       ]                                                         â”‚
â”‚     }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“ RESPONSE
                    JSON com HTML
                          â”‚
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND: JavaScript `loadStatusTab()`                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. Recebe resposta JSON                                         â”‚
â”‚  2. Renderiza HTML na tabela: <tbody>{{ data.html }}</tbody>   â”‚
â”‚  3. Re-inicializa listeners (botÃµes, etc)                       â”‚
â”‚  4. Update de loading state                                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Fluxo de Filtragem por Status

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab: "TODOS" (status=all)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  SQL: SELECT * FROM bank_statements                             â”‚
â”‚       WHERE company_id = 1                                      â”‚
â”‚         AND entidade_financeira_id = 5                          â”‚
â”‚         -- âŒ SEM filtro de status_conciliacao                   â”‚
â”‚       ORDER BY updated_at DESC                                  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Retorna TODOS: ok + pendente + ignorado + divergente         â”‚
â”‚  ğŸ“Š Total de registros: 21                                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€ Conciliado (ok)     = 15
                              â”œâ”€ Pendente            = 3
                              â”œâ”€ Ignorado            = 2
                              â””â”€ Divergente          = 1
                                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                 TOTAL              = 21

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab: "CONCILIADOS" (status=ok)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  SQL: SELECT * FROM bank_statements                             â”‚
â”‚       WHERE company_id = 1                                      â”‚
â”‚         AND entidade_financeira_id = 5                          â”‚
â”‚         AND status_conciliacao = 'ok'  -- âœ… FILTRO ATIVO        â”‚
â”‚       ORDER BY updated_at DESC                                  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Retorna APENAS: ok                                           â”‚
â”‚  ğŸ“Š Total de registros: 15                                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab: "PENDENTES" (status=pendente)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  SQL: SELECT * FROM bank_statements                             â”‚
â”‚       WHERE company_id = 1                                      â”‚
â”‚         AND entidade_financeira_id = 5                          â”‚
â”‚         AND status_conciliacao = 'pendente'  -- âœ… FILTRO ATIVO  â”‚
â”‚       ORDER BY updated_at DESC                                  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Retorna APENAS: pendente                                     â”‚
â”‚  ğŸ“Š Total de registros: 3                                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab: "IGNORADOS" (status=ignorado)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  SQL: SELECT * FROM bank_statements                             â”‚
â”‚       WHERE company_id = 1                                      â”‚
â”‚         AND entidade_financeira_id = 5                          â”‚
â”‚         AND status_conciliacao = 'ignorado'  -- âœ… FILTRO ATIVO  â”‚
â”‚       ORDER BY updated_at DESC                                  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Retorna APENAS: ignorado                                     â”‚
â”‚  ğŸ“Š Total de registros: 2                                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tab: "DIVERGENTES" (status=divergente)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  SQL: SELECT * FROM bank_statements                             â”‚
â”‚       WHERE company_id = 1                                      â”‚
â”‚         AND entidade_financeira_id = 5                          â”‚
â”‚         AND status_conciliacao = 'divergente'  -- âœ… FILTRO ATIVO â”‚
â”‚       ORDER BY updated_at DESC                                  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Retorna APENAS: divergente                                   â”‚
â”‚  ğŸ“Š Total de registros: 1                                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### CÃ³digo Chave - Controller

```php
// ğŸ”‘ PONTO CRÃTICO: Filtragem Condicional

$statusPermitidos = ['ok', 'pendente', 'ignorado', 'divergente', 'all', 'todos'];
if (!in_array($status, $statusPermitidos)) {
    $status = 'ok';
}

// Query base SEMPRE tem estes filtros:
$query = BankStatement::query()
    ->where('company_id', $activeCompanyId)         // ğŸ‘ˆ Sempre
    ->where('entidade_financeira_id', $id);        // ğŸ‘ˆ Sempre

// âœ¨ MAS status_conciliacao Ã© CONDICIONAL:
if (!in_array($status, ['all', 'todos'])) {
    // Se Ã© um status especÃ­fico, filtra
    $query->where('status_conciliacao', $status);
} else {
    // Se Ã© 'all' ou 'todos', NÃƒO filtra
    // Retorna TODOS os status
}

// Eager loading e ordenaÃ§Ã£o
$query->with(['transacoes.lancamentoPadrao', 'transacoes.createdBy'])
    ->latest('updated_at');
```

---

### Estrutura de Dados Retornada

```json
{
  "success": true,
  "html": "<tr>...</tr><tr>...</tr>...",
  "meta": {
    "current_page": 1,
    "last_page": 3,
    "total": 21,
    "per_page": 10
  }
}
```

---

### VerificaÃ§Ã£o de Contadores

```
Frontend (JavaScript):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const counts = {
  'all':       21,      // Soma: 15 + 3 + 2 + 1
  'ok':        15,
  'pendente':   3,
  'ignorado':   2,
  'divergente': 1
};

// Renderizado nas abas:
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Todosâ”‚Conciliadosâ”‚Pendentesâ”‚Ignoradosâ”‚Divergentesâ”‚
â”‚ (21) â”‚  (15)    â”‚  (3)   â”‚ (2)   â”‚   (1)    â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Backend (SQL):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SELECT status_conciliacao, COUNT(*) as total
FROM bank_statements
WHERE company_id = 1 AND entidade_financeira_id = 5
GROUP BY status_conciliacao;

// Resultado:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ status_conciliacaoâ”‚ total â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ok               â”‚  15   â”‚
â”‚ pendente         â”‚   3   â”‚
â”‚ ignorado         â”‚   2   â”‚
â”‚ divergente       â”‚   1   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL            â”‚  21   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Sequence Diagram

```
Usuario          Frontend              Backend              DB
   â”‚                â”‚                    â”‚                  â”‚
   â”‚â”€ Click Tab â”€â”€â†’ â”‚                    â”‚                  â”‚
   â”‚                â”‚ Fetch AJAX        â”‚                  â”‚
   â”‚                â”‚ ?status=pendente  â”‚                  â”‚
   â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’                  â”‚
   â”‚                â”‚                    â”‚ ValidaÃ§Ã£o      â”‚
   â”‚                â”‚                    â”‚ âœ“              â”‚
   â”‚                â”‚                    â”‚                â”‚
   â”‚                â”‚                    â”‚ Build Query    â”‚
   â”‚                â”‚                    â”‚ WHERE status   â”‚
   â”‚                â”‚                    â”‚ = 'pendente'   â”‚
   â”‚                â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
   â”‚                â”‚                    â”‚                â”‚ SELECT
   â”‚                â”‚                    â”‚                â”‚ EXECUTE
   â”‚                â”‚                    â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                â”‚                    â”‚ Results: 3     â”‚
   â”‚                â”‚                    â”‚                â”‚
   â”‚                â”‚                    â”‚ Mapear dados   â”‚
   â”‚                â”‚                    â”‚ Renderizar HTMLâ”‚
   â”‚                â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ JSON Response  â”‚
   â”‚                â”‚                    â”‚                â”‚
   â”‚ â† Update DOM â† â”‚                    â”‚                â”‚
   â”‚ 3 linhas      â”‚                    â”‚                â”‚
   â”‚                â”‚                    â”‚                â”‚
```

---

### Cache & Performance

```
Browser Memory:
â””â”€ loadedTabs = Set(['all', 'ok', 'pendente', ...])
   
   Se usuÃ¡rio clica em 'pendente' 2x:
   1ï¸âƒ£ Primeira vez:  Fetch AJAX â† Carrega do BD
   2ï¸âƒ£ Segunda vez:   Skip! (jÃ¡ estÃ¡ em loadedTabs)
   
   âœ… Evita mÃºltiplos requests desnecessÃ¡rios
```

---

**Diagrama criado em:** 25 de janeiro de 2026
**VersÃ£o:** 1.0
